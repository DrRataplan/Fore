<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes"/>

    <title>todo</title>

    <script src="../assets/@webcomponents/webcomponentsjs/webcomponents-loader.js"/>
    <script type="module" src="../elements/xf-form.js"></script>
    <script type="module" src="../elements/xf-repeat.js"></script>

</head>
<body>
    <!-- xf-model is not exposed to the client! -->
    <xf-model id="record">
        <xf-instance>
            <data>
                <task complete="false" due="2019-02-04">Pick up Milk</task>
                <task complete="true" due="2019-01-04">Make tutorial part 1</task>
            </data>
        </xf-instance>

        <xf-bind id="b-todo" set="task">
            <xf-bind id="b-task" ref="./text()" required="true()"></xf-bind>
            <xf-bind id="b-state" ref="@complete" type="xs:boolean"> </xf-bind>
            <xf-bind id="b-due" ref="@due" type="xs:date"> </xf-bind>
        </xf-bind>

        <xf-bind id="todo">
            <item idx="1">

            </item>
            <item idx="2">

            </item>
        </xf-bind>


        <xf-instance id="template">
            <data>
                <task complete="false" due=""></task>
            </data>
        </xf-instance>
        <!--<xf-bind id="todoTmpl" ref="$instances?template//task"> </xf-bind>-->


        <!--
        'db' scheme here is used as a posssible sample to write to an absolute address
        -->
        <xf-submission id="s-save" resource="xmldb:doc('/db/apps/fore/data/todo.xml')" method="put" replace="none">
            <xf-submit-error>
                <xf-message modal="false">storing record failed</xf-message>
            </xf-submit-error>
            <xf-submit-done>
                <!-- start over -->
                <xf-load url="seed-form.html"/>
                <xf-message level="ephemeral">Your data have been stored</xf-message>
            </xf-submit-done>
        </xf-submission>

    </xf-model>


    <xf-form>
        <xf-repeat id="r-todos" bind="b-todo">
            <input bind="b-task"/>
            <input bind="b-state" type="checkbox" />
            <input bind="b-due" type="date"/>
        </xf-repeat>
        <button>
            <xf-append bind="todo" template="todoTmpl">add</xf-append>
        </button>
        <button>
            <xf-delete bind="todo" at="index('r-todos')">delete</xf-delete>
        </button>
    </xf-form>
</body>
</html>